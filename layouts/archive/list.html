{{ define "main" }}

{{ $isntDefault := not (or (eq (trim $.Site.Params.contentTypeName " ") "posts") (eq (trim $.Site.Params.contentTypeName " ") "")) }}
{{ $contentTypeName := cond $isntDefault (string $.Site.Params.contentTypeName) "posts" }}

{{/*  修改时间样式  */}}
<style>
  .archive__post-title a span.updated-date {
    font-size: 15px;
    font-weight: 100;
    float: right;
    opacity: .8
  }

  #series a {
    font-size: 1.2rem;
    text-decoration: none;
    margin-right: 1rem;
    line-break: auto;
  }

  @media (max-width:683px) {
    #series a {
      font-size: 0.95rem;
      margin-right: 0.5rem;
    }
  }
</style>

<div class="archive">
  <h1>{{ .Title }}</h1>

  {{/*  系列  */}}
  {{/*  <div id="series">
    {{- range $name, $taxonomy := .Site.Taxonomies.series -}}
  <a href="/series/{{ $name | urlize }}">#{{ replace $name "-" " " | title}}<small>({{ .Count }})</small></a>
  {{- end -}}
</div> */}}

{{ range .Site.RegularPages.GroupByPublishDate "2006" }}
{{ if ne .Key "0001" }}
<div class="archive__group-year">
  <h2 class="archive__group-year-header">{{ replace .Key "0001" "" }}</h2>
  {{ range .Pages.GroupByDate "January" }}
  <div class="archive__group-month">
    <h3 class="archive__group-month-header">{{ .Key }}</h3>
    <div class="archive__group-posts">
      {{ range where .Pages "Type" $contentTypeName }}
      {{ if eq .Kind "page" }}
      <div class="archive__post">
        <h3 class="archive__post-title">
          <a href="{{ .Permalink }}">{{ .Title | markdownify }}
            {{/*  修改时间  */}}
            <span class="updated-date">

              <!-- Calculate the age in days and months -->
              {{ $ageDays := div (sub now.Unix .Lastmod.Unix) 86400 }}
              {{ $ageMonths := div (sub now.Unix .Lastmod.Unix) 2592000 }}

              <!-- Updated today -->
              {{ if eq $ageDays 0 }}
              Updated today

              <!-- Updated in the last 31 days -->
              {{ else if lt $ageDays 31 }}
              Updated {{ $ageDays }} {{ cond (eq $ageDays 1) "day" "days"}} ago

              <!-- Updated month(s) ago -->
              {{ else }}
              Updated {{ $ageMonths }} {{ cond (eq $ageMonths 1) "month" "months" }} ago

              {{ end }}
            </span>
            {{/*  修改时间  */}}
          </a>
        </h3>
        <div class="archive__post-meta">
          <span class="archive__post-date">
            {{ .Date.Format ($.Site.Params.DateFormatList | default "2006-01-02") }}
          </span>

          {{ with .Params.Author }}
          <span class="archive__post-author">/{{ $.Site.Params.WrittenBy | default "" }}{{ . }}
          </span>
          {{ end }}
          {{ if $.Site.Params.ShowReadingTime }}
          <span class="archive__post-read-time">/ Need {{ .ReadingTime }}
            {{ $.Site.Params.MinuteReadingTime | default "minutes read" }}</span>
          {{ end }}

        </div>
      </div>
      {{ end }}
      {{ end }}
    </div>
  </div>
  {{ end }}
</div>
{{ end }}
{{ end }}
</div>
{{ end }}