{{ define "main" }}

<div class="archive">
  <h1>{{ .Title }}</h1>

  {{ range .Site.RegularPages.GroupByPublishDate "2006" }}
  {{ if ne .Key "0001" }}

  <div class="archive__group-year">
    <h2 class="archive__group-year-header">{{ replace .Key "0001" "" }}</h2>

    {{ range .Pages.GroupByDate "January" }}
    <div class="archive__group-month">
      <h3 class="archive__group-month-header">{{ .Key }}</h3>
      <div class="archive__group-posts">

        <!-- 只显示 Posts 类别 -->
        {{ range where .Pages "Type" "posts" }}
        {{ if eq .Kind "page" }}
        <div class="archive__post">

          <!-- 标题 -->
          <h3 class="archive__post-title">
            <a target="_blank" href="{{ .Permalink }}">{{ .Title | markdownify }}

              <!-- 计算修改时间 -->
              <span class="archive__updated-date">
                {{ $ageDays := div (sub now.Unix .Lastmod.Unix) 86400 }}
                {{ $ageMonths := div (sub now.Unix .Lastmod.Unix) 2592000 }}
                {{ if eq $ageDays 0 }}
                Updated today
                {{ else if lt $ageDays 31 }}
                Updated {{ $ageDays }} {{ cond (eq $ageDays 1) "day" "days"}} ago
                {{ else }}
                Updated {{ $ageMonths }} {{ cond (eq $ageMonths 1) "month" "months" }} ago
                {{ end }}
              </span>
            </a>
          </h3>

          <!-- 标题下的元数据 -->
          <div class="archive__post-meta">

            <!-- 创建时间 -->
            <span class="archive__post-date">
              {{ .Date.Format ($.Site.Params.DateFormatList | default "2006-01-02") }}
            </span>

            <!-- 作者 -->
            <!-- {{ with .Params.Author }}
            <span class="archive__post-author">/ {{ $.Site.Params.WrittenBy | default "" }}{{ . }}
            </span>
            {{ end }} -->

            <!-- 标签 -->
            {{ if .Params.tags }}
            <span class="archive__post-tags">
              {{ range .Params.tags }}
              <a href="{{ (urlize (printf "tags/%s" . )) | absURL }}/">#{{ . }}</a>&nbsp;
              {{ end }}
            </span>
            {{ end }}

            <!-- 系列 -->
            {{ if .Params.series }}
            <span class="archive__post-series">
              {{ range .Params.series }}
              <a href="{{ (urlize (printf "series/%s" . )) | absURL }}/">@{{ . }}</a>&nbsp;
              {{ end }}
            </span>
            {{ end }}

          </div>
        </div>
        {{ end }}
        {{ end }}
      </div>
    </div>
    {{ end }}
  </div>
  {{ end }}
  {{ end }}
</div>
{{ end }}